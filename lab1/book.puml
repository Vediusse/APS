@startuml
skinparam shadowing false
skinparam actorStyle awesome

title Процесс бронирования и использования ресурса

start

partition "Пользователь" {
    :Открытие приложения/веб-интерфейса;
    :Просмотр доступности ресурсов (ФТ-001.01.01);
    repeat
        :Выбор ресурса (ФТ-001.02.01);
        :Выбор даты и времени бронирования (ФТ-001.02.02);
        :Проверка доступности (ФТ-001.01.03);
    repeat while (Ресурс недоступен или время занято) is (Повторить выбор) not (Продолжить)
    :Подтверждение бронирования;
    :Оплата бронирования (ФТ-010.02);
    -> Уведомление о подтверждении бронирования (ФТ-005.01.03);
    note right
        Система регистрирует бронирование
        и финансовую операцию (ФТ-010.03)
    end note
}

partition "Система бронирования" {
    fork
        :Начало бронирования;
        :Отправка уведомления за 15 минут до начала (ФТ-005.01.01);
    fork again
        :Активация физического ресурса (ФТ-002.01);
        :Применение программного профиля (ФТ-004.01);
    end fork
}

partition "Пользователь" {
    :Доступ к ресурсу через QR/NFC (ФТ-003.01, ФТ-003.02);
    note right
        Система валидирует бронирование (ФТ-003.03)
        и логирует попытку доступа (ФТ-003.04)
    end note
    :Использование ресурса;
    :Получение уведомления об окончании (ФТ-005.01.02);
}

partition "Система бронирования" {
    fork
        :За 15 минут до окончания;
        :Отправка уведомления об окончании (ФТ-005.01.02);
    fork again
        :Окончание бронирования;
        :Деактивация физического ресурса (ФТ-002.02);
        :Возврат к стандартному профилю (ФТ-004.02);
        :Отправка уведомления по факту окончания (ФТ-005.01.02);
        note left
            Система мониторит задержку деактивации (ФТ-018.01)
            и начисляет штрафы при превышении (ФТ-018.02)
        end note
    end fork
}

partition "Пользователь" {
    :Возможность оставить отзыв/оценку (ФТ-014.01);
}

stop
@enduml